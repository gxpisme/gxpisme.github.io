# 架构的演变历程

## 单机服务器
> 背景: 用户量很少，基本上没有人访问，单机服务器显然够用。
>
> 目的: 就是让用户够用就行。
>
> 操作：搭建一台服务器，上面部署了应用程序，数据库，文件。

- 非常原始并且简单的一个服务器，可以把这个阶段理解为一个小的博客网站。其实就是一个demo网站，因为用户量很少，没有什么访问量，一两分钟还不来访问一次呢，所以这样的架构完全够用了。

![](/image/architecture-history-1.png)

## 三台服务器
> 背景: 随着业务的发展，单机服务器扛不住了，性能越来越差，用户访问网页，半天还打不开，用户快气死了。单机服务器内存、磁盘、CPU都满满的，在不整治，就挂了。
>
> 目的: 就是让用户可用，能够满足用户的需求，起码能正常打开网页吧。
>
> 操作：搭建三台服务器，分别是应用服务器，数据库服务器，文件服务器。将这三块进行分离，架构清晰，也方面后面进行扩展。

- 根据不同的场景及需求，合理分配不同配置的机器给到应用、数据库、文件服务器。
- 应用服务器占用CPU较多，应用程序经常进行逻辑计算，业务逻辑处理，比较占用CPU，应该选择CPU偏好的机器。
- 数据库服务器占用内存磁盘较多，数据库用于存储数据，查询数据，存储数据需要磁盘大的，查询数据需要内存大的机器，应该选用内存磁盘偏好的机器。
- 文件服务器占用磁盘较多，文件服务器基本上都是存储文件的，需求点在磁盘空间，所以应该选用磁盘较大的机器。

![](/image/architecture-history-2.png)


## 引入缓存
> 背景: 网站访问的特点，大部分流量都会落到部分数据上，这些数据称为热点数据。用户访问量的增加，使得性能也越来越差，数据库扛不住了。
>
> 目的: 就是让用户可用，能够满足用户的需求。
>
> 操作：搭建缓存服务器，将热点数据放入缓存服务器中，从而降级数据库服务器的负载。 缓存服务器可以是分布式的，这样就不用受到容量的限制了。

- 也可以有些本地缓存的情况，本地缓存更快。但其容量严格会受到应用服务器的限制。
- 最佳实践就是能用分布式缓存，尽量用分布式缓存。本地缓存除非有特别的场景才用。缓存越多，数据不一致的情况越严重。

![](/image/architecture-history-3.png)


## 应用服务器集群
> 背景: 应用服务器的处理能力不足，存储空间不足，无法支撑用户的访问。
>
> 目的: 就是让用户可用，能够满足用户的需求。
>
> 操作：搭建应用服务器集群。当一台服务器的处理能力、存储空间不足时，不要企图去更换更强大的服务器，对大型网站而言，不管多么强大的服务器，都满足不了网站持续增长的业务需求。这种情况下，更恰当的做法是增加一台服务器分担原有服务器的访问及存储压力。 对网站架构而言，只要能通过增加一台服务器的方式改善负载压力，就可以以同样的方式持续增加服务器不断改善系统性能，从而实现系统的可伸缩性。应用服务器实现集群是网站可伸缩架构设计中较为简单成熟的一种。

- 使用集群是网站解决高并发、海量数据问题的常用手段。

![](/image/architecture-history-4.png)



![](/image/architecture-history-5.png)
![](/image/architecture-history-6.png)
![](/image/architecture-history-7.png)
![](/image/architecture-history-8.png)
![](/image/architecture-history-9.png)
![](/image/architecture-history-10.png)
